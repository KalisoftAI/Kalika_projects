{% extends 'base.html' %}

{% block title %}Export Store Data{% endblock %}

{% block content %}
<div class="card-glass mt-4 p-6 rounded-xl">
    <div class="card-header bg-secondary-dark text-white p-4 rounded-t-lg -mx-6 -mt-6 mb-6">
        <h5 class="text-xl font-semibold">Export Store Data</h5>
    </div>
    <div class="card-body">
        <div id="alertContainer" class="mt-4"></div>

        <form id="exportForm" onsubmit="event.preventDefault(); submitExport();">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h6 class="text-lg font-semibold mb-4 text-text-primary">Select Export Options</h6>
                    <ul class="space-y-3">
                        {# Export Item Information #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportItemInformation" name="exportOption" value="Export Item Information" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportItemInformation" class="text-text-primary">Export Item Information</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpItemInfoModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Multi Language For Items #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportMultiLanguageItems" name="exportOption" value="Export Multi Language For Items" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportMultiLanguageItems" class="text-text-primary">Export Multi Language For Items</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpMultiLangItemsModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Category Information #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportCategoryInformation" name="exportOption" value="Export Category Information" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportCategoryInformation" class="text-text-primary">Export Category Information</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpCategoryInfoModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Multi Language For Categories #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportMultiLanguageCategories" name="exportOption" value="Export Multi Language For Categories" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportMultiLanguageCategories" class="text-text-primary">Export Multi Language For Categories</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpMultiLangCategoriesModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Item Price #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportItemPrice" name="exportOption" value="Export Item Price" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportItemPrice" class="text-text-primary">Export Item Price</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpItemPriceModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Multi Language For Item Properties #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportMultiLanguageItemProperties" name="exportOption" value="Export Multi Language For Item Properties" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportMultiLanguageItemProperties" class="text-text-primary">Export Multi Language For Item Properties</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpMultiLangItemPropsModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Item Properties #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportItemProperties" name="exportOption" value="Export Item Properties" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportItemProperties" class="text-text-primary">Export Item Properties</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpItemPropertiesModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Multi Language For Item Attributes #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportMultiLanguageItemAttributes" name="exportOption" value="Export Multi Language For Item Attributes" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportMultiLanguageItemAttributes" class="text-text-primary">Export Multi Language For Item Attributes</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpMultiLangItemAttrsModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Item Attributes #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportItemAttributes" name="exportOption" value="Export Item Attributes" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportItemAttributes" class="text-text-primary">Export Item Attributes</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpItemAttributesModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Multi Language For Item Options #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportMultiLanguageItemOptions" name="exportOption" value="Export Multi Language For Item Options" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportMultiLanguageItemOptions" class="text-text-primary">Export Multi Language For Item Options</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpMultiLangItemOptionsModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Item Taxrates #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportItemTaxrates" name="exportOption" value="Export Item Taxrates" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportItemTaxrates" class="text-text-primary">Export Item Taxrates</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpItemTaxratesModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Items In Froogle XLS Format #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportItemsFroogle" name="exportOption" value="Export Items In Froogle XLS Format" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportItemsFroogle" class="text-text-primary">Export Items In Froogle XLS Format</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpItemsFroogleModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Report #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportReport" name="exportOption" value="Export Report" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportReport" class="text-text-primary">Export Report</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpReportModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Retailers #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportRetailers" name="exportOption" value="Export Retailers" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportRetailers" class="text-text-primary">Export Retailers</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpRetailersModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Customer Form Data #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportCustomerFormData" name="exportOption" value="Export Customer Form Data" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportCustomerFormData" class="text-text-primary">Export Customer Form Data</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpCustomerFormDataModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>
                    </ul>
                </div>

                <div>
                    <h6 class="text-lg font-semibold mb-4 text-text-primary">Additional Export Options</h6>
                    <ul class="space-y-3">
                        {# Export Related Items #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportRelatedItems" name="exportOption" value="Export Related Items" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportRelatedItems" class="text-text-primary">Export Related Items</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpRelatedItemsModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Store Template #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportStoreTemplate" name="exportOption" value="Export Store Template" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportStoreTemplate" class="text-text-primary">Export Store Template</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpStoreTemplateModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Bundle Items #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportBundleItems" name="exportOption" value="Export Bundle Items" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportBundleItems" class="text-text-primary">Export Bundle Items</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpBundleItemsModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Add-ons Items #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportAddonsItems" name="exportOption" value="Export Add-ons Items" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportAddonsItems" class="text-text-primary">Export Add-ons Items</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpAddonsItemsModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export External Giftcard Mapping #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportGiftcardMapping" name="exportOption" value="Export External Giftcard Mapping" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportGiftcardMapping" class="text-text-primary">Export External Giftcard Mapping</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpGiftcardMappingModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Category Properties #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportCategoryProperties" name="exportOption" value="Export Category Properties" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportCategoryProperties" class="text-text-primary">Export Category Properties</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpCategoryPropertiesModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Item SKU #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportItemSKU" name="exportOption" value="Export Item SKU" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportItemSKU" class="text-text-primary">Export Item SKU</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpItemSKUModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Question #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportQuestion" name="exportOption" value="Export Question" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportQuestion" class="text-text-primary">Export Question</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpQuestionModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Abandoned Products #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportAbandonedProducts" name="exportOption" value="Export Abandoned Products" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportAbandonedProducts" class="text-text-primary">Export Abandoned Products</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpAbandonedProductsModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Items Reviews #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportItemsReviews" name="exportOption" value="Items Reviews" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportItemsReviews" class="text-text-primary">Items Reviews</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpItemsReviewsModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Export Order Approvers #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportOrderApprovers" name="exportOption" value="Export Order Approvers" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportOrderApprovers" class="text-text-primary">Export Order Approvers</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpOrderApproversModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>

                        {# Multi Value Properties #}
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="exportMultiValueProperties" name="exportOption" value="Multi Value Properties" class="form-checkbox text-accent-indigo rounded">
                            <label for="exportMultiValueProperties" class="text-text-primary">Multi Value Properties</label>
                            <button type="button" class="text-accent-indigo hover:text-accent-indigo/80" onclick="openHelpModal('helpMultiValuePropertiesModal')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="flex justify-end mt-8">
                <button type="submit" class="px-6 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200">Generate Export</button>
            </div>
        </form>
    </div>
</div>

{# --- Help Modals --- #}

{# Help Modal Template #}
<div id="helpItemInfoModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Item Information</h4>
        <p class="text-sm text-text-secondary mb-4">
            By selecting this line, you will generate the export report with the Item Detail Information from the store selected.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpItemInfoModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpMultiLangItemsModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Multi Language For Items</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports item information including multi-language fields.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpMultiLangItemsModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpCategoryInfoModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Category Information</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports detailed category information.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpCategoryInfoModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpMultiLangCategoriesModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Multi Language For Categories</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports category information including multi-language fields.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpMultiLangCategoriesModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpItemPriceModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Item Price</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports the pricing details for all items.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpItemPriceModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpMultiLangItemPropsModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Multi Language For Item Properties</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports item properties, including multi-language fields.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpMultiLangItemPropsModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpItemPropertiesModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Item Properties</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports all defined properties for items.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpItemPropertiesModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpMultiLangItemAttrsModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Multi Language For Item Attributes</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports item attributes, including multi-language fields.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpMultiLangItemAttrsModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpItemAttributesModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Item Attributes</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports all defined attributes for items.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpItemAttributesModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpMultiLangItemOptionsModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Multi Language For Item Options</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports item options, including multi-language fields.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpMultiLangItemOptionsModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpItemTaxratesModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Item Taxrates</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports the tax rates applied to items.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpItemTaxratesModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpItemsFroogleModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Items In Froogle XLS Format</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports item data in a format compatible with Froogle (Google Shopping).
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpItemsFroogleModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpReportModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Report</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option generates a general export report.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpReportModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpRetailersModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Retailers</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports information about registered retailers.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpRetailersModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpCustomerFormDataModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Customer Form Data</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports data submitted through customer forms.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpCustomerFormDataModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpRelatedItemsModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Related Items</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports information about related items configurations.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpRelatedItemsModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpStoreTemplateModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Store Template</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports the current store template settings.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpStoreTemplateModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpBundleItemsModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Bundle Items</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports information about bundled items.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpBundleItemsModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpAddonsItemsModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Add-ons Items</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports information about add-on items.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpAddonsItemsModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpGiftcardMappingModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export External Giftcard Mapping</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports mapping data for external gift cards.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpGiftcardMappingModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpCategoryPropertiesModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Category Properties</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports properties associated with categories.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpCategoryPropertiesModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpItemSKUModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Item SKU</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports the Stock Keeping Unit (SKU) for all items.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpItemSKUModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>


<div id="helpAbandonedProductsModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Abandoned Products</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports data on products left in abandoned carts.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpAbandonedProductsModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpItemsReviewsModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Items Reviews</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports all product review data.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpItemsReviewsModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpOrderApproversModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Export Order Approvers</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports data on users designated as order approvers.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpOrderApproversModal')" class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">OK</button>
        </div>
    </div>
</div>

<div id="helpMultiValuePropertiesModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-card-bg p-6 rounded-lg shadow-xl max-w-md w-full text-text-primary animate-scale-in">
        <h4 class="text-lg font-semibold mb-3">Multi Value Properties</h4>
        <p class="text-sm text-text-secondary mb-4">
            This option exports properties that can hold multiple values.
            You will be forwarded to the Status page, and you need to wait until the "Download" icon appears at the right side so that you can download the .xls file.
        </p>
        <div class="flex justify-end">
            <button type="button" onclick="closeHelpModal('helpMultiValuePropertiesModal')" 
            class="px-4 py-2 rounded-md bg-accent-indigo text-white hover:bg-accent-indigo/80 transition-colors duration-200 text-sm">Download</button>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
    // Common alert/toast functions (assuming they are in base.html or a common JS file)
    function showAlert(message, type) {
        const alertContainer = document.getElementById('alertContainer');
        if (alertContainer) {
            alertContainer.innerHTML = `
                <div class="p-3 mb-4 rounded-md text-sm ${type === 'success' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                    ${message}
                </div>
            `;
            alertContainer.classList.remove('hidden');
            setTimeout(() => {
                alertContainer.classList.add('hidden');
                alertContainer.innerHTML = '';
            }, 5000);
        } else {
            console.warn('Alert container not found. Displaying alert via console.');
            if (type === 'success') {
                console.log('Success: ' + message);
            } else {
                console.error('Error: ' + message);
            }
        }
    }

    function openHelpModal(modalId) {
        document.getElementById(modalId).classList.remove('hidden');
        document.body.style.overflow = 'hidden'; // Prevent scrolling background
    }

    function closeHelpModal(modalId) {
        document.getElementById(modalId).classList.add('hidden');
        document.body.style.overflow = ''; // Restore scrolling
    }

    async function submitExport() {
        const selectedOptions = Array.from(document.querySelectorAll('input[name="exportOption"]:checked'))
                                   .map(checkbox => checkbox.value);

        if (selectedOptions.length === 0) {
            showAlert('Please select at least one export option.', 'error');
            return;
        }

        showAlert('Initiating export process...', 'info');

        try {
            const response = await fetch('/admin/api/initiate-export', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                body: JSON.stringify({ export_options: selectedOptions }),
            });

            if (response.ok) {
                // Redirect to the status page on success
                window.location.href = '/admin/export-status';
            } else {
                const result = await response.json();
                showAlert(result.message || 'Failed to initiate export.', 'error');
            }
        } catch (error) {
            console.error('Error initiating export:', error);
            showAlert('An unexpected error occurred during export.', 'error');
        }
    }
</script>
{% endblock %}
