<style>
    /* Add this CSS to control the dropdown behavior */
    .navbar { display: flex; justify-content: space-between; align-items: center; width: 100%; }
    .dropdown1 { position: relative; }
    .dropdown-menu { display: none; position: absolute; top: 100%; left: 0; z-index: 1000; background-color: white; border: 1px solid #ccc; list-style: none; padding: 0; margin-top: 5px; min-width: 220px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    .dropdown-submenu { display: none; position: absolute; left: 100%; top: -1px; background-color: white; border: 1px solid #ccc; list-style: none; padding: 0; }
    .dropdown-menu > li { position: relative; }
    .dropdown-menu > li:hover > .dropdown-submenu { display: block; }
</style>

<div class="navbar-nav">
    <div class="dropdown1">
        <button class="btn-categories" id="categories-btn"><i class="fa fa-list"></i> All Categories</button>
        <ul class="dropdown-menu" id="categories-menu">
            {% for maincategory, subcategories in categories.items() %}
                <li>
                    <a href="{{ url_for('products_by_category', main_category_name=maincategory) }}">{{ maincategory }}</a>
                    {% if subcategories %}
                    <ul class="dropdown-submenu">
                        {% for subcategory in subcategories %}
                            <li><a href="{{ url_for('products_by_subcategory', main_category_name=maincategory, sub_category_name=subcategory) }}">{{ subcategory }}</a></li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    </div>
</div>
<div class="navbar-logo"><a href="/"><img src="{{ url_for('static', filename='image/logo.png') }}" alt="Logo" class="logo-image"></a></div>
<div class="header-actions">
  <form action="{{ url_for('search_products') }}" method="GET" style="display: flex;">
      <input type="text" name="query" class="search-bar" placeholder="Search for products..." required />
      <button type="submit" id="searchBtn"><i class="fa fa-search"></i></button>
  </form>
</div>
<a href="{{ url_for('cart1.cart') }}" class="btn-login"><i class="fa fa-shopping-cart"></i> (<span class="cart-count">0</span>)</a>
<div id="user-personalization"><a href="{{ url_for('login1.login') }}" class="btn-login" id="login-button"><i class="fa fa-user"></i> Login</a></div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const categoriesBtn = document.getElementById('categories-btn');
        const categoriesMenu = document.getElementById('categories-menu');
        if (categoriesBtn) {
            categoriesBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                categoriesMenu.style.display = (categoriesMenu.style.display === 'block') ? 'none' : 'block';
            });
        }
        document.addEventListener('click', function() {
            if (categoriesMenu) categoriesMenu.style.display = 'none';
        });
    });
</script>