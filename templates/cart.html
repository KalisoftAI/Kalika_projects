{% extends "base.html" %}

{% block title %}Your Shopping Cart{% endblock %}

{% block extra_css %}
<style>
    .cart-container { max-width: 1000px; margin: 40px auto; }
    .cart-table { width: 100%; border-collapse: collapse; }
    .cart-table th, .cart-table td { border-bottom: 1px solid #ddd; padding: 15px; text-align: left; vertical-align: middle; }
    .cart-table th { background-color: #f8f9fa; font-weight: bold; }
    .cart-item-image { width: 80px; height: 80px; object-fit: cover; border-radius: 4px; }
    .product-info { display: flex; align-items: center; }
    .product-info div { margin-left: 15px; }
    .quantity-input { width: 60px; text-align: center; padding: 5px; }
    .remove-btn { color: #dc3545; text-decoration: none; font-size: 1.2em; background: none; border: none; cursor: pointer; }
    .cart-summary { width: 300px; float: right; margin-top: 20px; background: #f8f9fa; padding: 20px; border-radius: 5px; }
    .cart-summary h3 { margin-top: 0; }
    .cart-actions { margin-top: 20px; text-align: right; }
    .btn { padding: 12px 25px; text-decoration: none; border-radius: 5px; color: white; border: none; cursor: pointer; font-size: 1em; }
    .btn-checkout { background-color: #28a745; }
    .empty-cart { text-align: center; padding: 50px; font-size: 1.2em; }
</style>
{% endblock %}

{% block content %}
<div class="cart-container">
    <h1>Your Shopping Cart</h1>

    {% if cart_items %}
    <table class="cart-table">
        <thead>
            <tr>
                <th>Product</th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Total</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for item in cart_items %}
            <tr>
                <td>
                    <div class="product-info">
                        <img src="{{ item.image_url }}" alt="{{ item.name }}" class="cart-item-image">
                        <div>{{ item.name }}</div>
                    </div>
                </td>
                <td>Rs. {{ "%.2f"|format(item.price) }}</td>
                <td>
                    <form action="{{ url_for('cart1.update_cart', product_code=item.code) }}" method="post" style="display:inline;">
                        <input type="number" name="quantity" value="{{ item.quantity }}" min="1" class="quantity-input">
                        <button type="submit" class="btn" style="padding: 5px 10px; font-size: 0.8em;">Update</button>
                    </form>
                </td>
                <td>Rs. {{ "%.2f"|format(item.price * item.quantity) }}</td>
                <td>
                    <form action="{{ url_for('cart1.remove_from_cart', product_code=item.code) }}" method="post">
                        <button type="submit" class="remove-btn" title="Remove item">&times;</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="cart-summary">
        <h3>Order Summary</h3>
        <p><strong>Grand Total: Rs. {{ "%.2f"|format(total_price) }}</strong></p>
        <div class="cart-actions">
            <a href="{{ url_for('cart1.checkout') }}" class="btn btn-checkout">Proceed to Checkout</a>
        </div>
    </div>

    {% else %}
    <div class="empty-cart">
        <p>Your cart is empty.</p>
        <a href="{{ url_for('home') }}" class="btn" style="background-color: #007bff;">Start Shopping</a>
    </div>
    {% endif %}
</div>
{% endblock %}